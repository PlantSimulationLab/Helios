<!-- HTML header for doxygen 1.12.0-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.13.2"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Helios: Collision Detection Plugin Documentation</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/javascript" src="clipboard.js"></script>
<script type="text/javascript" src="doxygen-awesome-darkmode-toggle.js"></script>
<script type="text/javascript" src="doxygen-awesome-paragraph_link.js"></script>
<script type="text/javascript" src="doxygen-awesome-tabs.js"></script>
<script type="text/javascript" src="doxygen-awesome-interactive-toc.js"></script>
<script type="text/javascript">
  DoxygenAwesomeDarkModeToggle.init()
  DoxygenAwesomeParagraphLink.init()
  DoxygenAwesomeTabs.init()
  DoxygenAwesomeInteractiveToc.init()
</script>
<script>
    try {
        // Remove the stored “last visited page” so the tree always starts fresh
        Cookie.eraseSetting('navpath');
        localStorage.removeItem('navpath');
        // Older Doxygen versions might use this key:
        localStorage.removeItem('nav-sync-path');
    } catch(e) {
        /* storage unavailable? ignore */
    }
</script>
<script type="text/javascript" src="navsync-default.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="cookie.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
  $(function() { init_search(); });
/* @license-end */
</script>
<script type="text/javascript">
window.MathJax = {
  options: {
    ignoreHtmlClass: 'tex2jax_ignore',
    processHtmlClass: 'tex2jax_process'
  }
};
</script>
<script type="text/javascript" id="MathJax-script" async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js"></script>
<link href="doxygen-awesome.css" rel="stylesheet" type="text/css" />
<link href="doxygen-awesome-sidebar-only-darkmode-toggle.css" rel="stylesheet" type="text/css"/>
<link href="custom.css" rel="stylesheet" type="text/css"/>
</head>
<!-- Google tag (gtag.js) -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-93BB4673PE"></script>
<script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());
    gtag('config', 'G-93BB4673PE');
</script>
<!-- Google tag (gtag.js) -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-3F0Y5Z6543"></script>
<script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());
    gtag('config', 'G-3F0Y5Z6543');
</script>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="5">
 <tbody>
 <tr id="projectrow">
  <td id="projectlogo"><img alt="Logo" src="Helios_logo_small.png"></td>
  <td id="projectalign">
   <div id="projectname">
       <span id="projectnumber">&#160;v1.3.41</span>
   </div>
  </td>
     <td id="searchbox-container">        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <span id="MSearchSelect"                onmouseover="return searchBox.OnSearchSelectShow()"                onmouseout="return searchBox.OnSearchSelectHide()">&#160;</span>
          <input type="text" id="MSearchField" value="" placeholder="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.svg" alt=""/></a>
          </span>
        </div>
</td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.13.2 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() { codefold.init(0); });
/* @license-end */
</script>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function(){initNavTree('_collision_detection_doc.html',''); initResizable(true); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div><div class="header">
  <div class="headertitle"><div class="title">Collision Detection Plugin Documentation</div></div>
</div><!--header-->
<div class="contents">
<div class="toc"><h3>Table of Contents</h3>
<ul>
  <li class="level1">
    <a href="#CDDepends">Dependencies</a>
  </li>
  <li class="level1">
    <a href="#CDIntro">Introduction</a>
  </li>
  <li class="level1">
    <a href="#CDConstructor">CollisionDetection Class Constructor</a>
  </li>
  <li class="level1">
    <a href="#CDVarsAndProps">Input/Output Primitive Data</a>
    <ul>
      <li class="level2">
        <a href="#CDInputData">Input Primitive Data</a>
      </li>
      <li class="level2">
        <a href="#CDOutputData">Output Primitive Data</a>
      </li>
    </ul>
  </li>
  <li class="level1">
    <a href="#CDUse">Using the Collision Detection Plugin</a>
    <ul>
      <li class="level2">
        <a href="#CDConst">Model Class Constructor</a>
      </li>
      <li class="level2">
        <a href="#CDBasicUsage">Basic Usage Workflow</a>
      </li>
      <li class="level2">
        <a href="#CDBVH">Bounding Volume Hierarchy (BVH)</a>
        <ul>
          <li class="level3">
            <a href="#CDBVHConstruction">BVH Construction</a>
          </li>
          <li class="level3">
            <a href="#CDBVHStats">BVH Statistics and Validation</a>
          </li>
        </ul>
      </li>
      <li class="level2">
        <a href="#CDCollisionQueries">Collision Queries</a>
        <ul>
          <li class="level3">
            <a href="#CDSinglePrimitive">Single Primitive Collision</a>
          </li>
          <li class="level3">
            <a href="#CDMultiplePrimitives">Multiple Primitive Collision</a>
          </li>
          <li class="level3">
            <a href="#CDObjectCollision">Object-Based Collision</a>
          </li>
        </ul>
      </li>
      <li class="level2">
        <a href="#CDGPU">GPU Acceleration</a>
        <ul>
          <li class="level3">
            <a href="#CDGPUEnable">Enabling/Disabling GPU Acceleration</a>
          </li>
          <li class="level3">
            <a href="#CDGPUPerformance">GPU Performance Considerations</a>
          </li>
          <li class="level3">
            <a href="#CDGPUMemory">GPU Memory Management</a>
          </li>
        </ul>
      </li>
      <li class="level2">
        <a href="#CDAdvanced">Advanced Features</a>
        <ul>
          <li class="level3">
            <a href="#CDMessageControl">Message Control</a>
          </li>
          <li class="level3">
            <a href="#CDErrorHandling">Error Handling</a>
          </li>
          <li class="level3">
            <a href="#CDDynamic">Dynamic Scenes</a>
          </li>
        </ul>
      </li>
      <li class="level2">
        <a href="#CDPerformance">Performance Guidelines</a>
      </li>
    </ul>
  </li>
  <li class="level1">
    <a href="#CDExamples">Example Applications</a>
    <ul>
      <li class="level2">
        <a href="#CDGrowthSim">Growth Simulation</a>
      </li>
      <li class="level2">
        <a href="#CDSpatialAnalysis">Spatial Analysis</a>
      </li>
    </ul>
  </li>
  <li class="level1">
    <a href="#CDTroubleshooting">Troubleshooting</a>
    <ul>
      <li class="level2">
        <a href="#CDCommonIssues">Common Issues</a>
      </li>
      <li class="level2">
        <a href="#CDDebugging">Debugging</a>
      </li>
    </ul>
  </li>
</ul>
</div>
<div class="textblock"><p><br  />
<br  />
 </p>
<table class="doxtable">
<tr>
<th>Dependencies </th><td>NVIDIA CUDA 9.0+ (optional)  </td></tr>
<tr>
<th>CMakeLists.txt </th><td>set( PLUGINS "collisiondetection" )  </td></tr>
<tr>
<th>Header File </th><td>include "CollisionDetection.h"  </td></tr>
<tr>
<th>Class </th><td><a class="el" href="class_collision_detection.html">CollisionDetection</a>  </td></tr>
</table>
<h1><a class="anchor" id="CDDepends"></a>
Dependencies</h1>
<table class="doxtable">
<tr>
<th>Package </th><td><div class="image">
<img src="apple-logo.png" alt=""/>
</div>
 </td><td><div class="image">
<img src="unix-logo.png" alt=""/>
</div>
 </td><td><div class="image">
<img src="windows-logo.png" alt=""/>
</div>
  </td></tr>
<tr>
<td>NVIDIA CUDA 9.0+ (optional) </td><td>Mac OSX: Not available </td><td>Use <a href="https://developer.nvidia.com/cuda-downloads">CUDA installer</a> </td><td>Use <a href="https://developer.nvidia.com/cuda-downloads">CUDA installer</a>  </td></tr>
</table>
<p>For help choosing the correct CUDA toolkit version and accompanying OptiX version for your system, consult this page: <a class="el" href="_choosing_c_u_d_a.html">Choosing the right CUDA and OptiX version</a></p>
<p>Useful OS-specific information for installing CUDA can be found here: <a class="el" href="_dependent_software.html">Install and Set-up</a></p>
<p>If you are using a PC, it is likely you will need to increase the GPU timeout in the registry, otherwise calculations lasting longer than 2 secs. will timeout and kill your program. A guide on how to increase the timeout can be found here: <a class="el" href="_p_c_g_p_u_timeout.html">Increasing graphics driver timeout</a></p>
<p><b>Note:</b> CUDA is optional for this plugin. The collision detection system will work on CPU-only systems, but GPU acceleration provides significant performance improvements for large scenes.</p>
<h1><a class="anchor" id="CDIntro"></a>
Introduction</h1>
<p>This plugin provides fast collision detection capabilities for arbitrary 3D geometry using GPU-accelerated spatial data structures. The system uses a Bounding Volume Hierarchy (BVH) to efficiently query which primitives intersect with a given primitive or spatial region. This is useful for applications such as growth simulation, physics-based modeling, procedural content generation, and spatial analysis.</p>
<p>The collision detection system supports both CPU and GPU acceleration. When GPU acceleration is available, the plugin automatically uses CUDA kernels to perform parallel collision queries, providing significant speedup for large scenes. The system gracefully falls back to CPU computation when GPU resources are unavailable.</p>
<p>Key features include:</p><ul>
<li>High-performance BVH construction using Surface Area Heuristic (SAH)</li>
<li>GPU-accelerated collision queries with automatic CPU fallback</li>
<li>Support for primitive-to-primitive and primitive-to-object collision detection</li>
<li>Efficient memory management with automatic cleanup</li>
<li>Integration with Helios primitive and object systems</li>
</ul>
<h1><a class="anchor" id="CDConstructor"></a>
CollisionDetection Class Constructor</h1>
<table class="doxtable">
<tr>
<th>Constructors  </th></tr>
<tr>
<td><a class="el" href="class_collision_detection.html">CollisionDetection( helios::Context* context )</a>  </td></tr>
</table>
<p>The <a class="el" href="class_collision_detection.html">CollisionDetection</a> class is initialized by passing a pointer to the Helios context as an argument to the constructor. This gives the class the ability to automatically query model geometry and read/write data from/to the context.</p>
<div class="fragment"><div class="line"><a class="code hl_class" href="class_collision_detection.html" title="Class for GPU-accelerated collision detection and spatial queries in Helios.">CollisionDetection</a> collision(&amp;context); <span class="comment">//declare the collision detection system</span></div>
</div><!-- fragment --><h1><a class="anchor" id="CDVarsAndProps"></a>
Input/Output Primitive Data</h1>
<h2><a class="anchor" id="CDInputData"></a>
Input Primitive Data</h2>
<p>The CollisionDetection plugin primarily works with the geometric properties of primitives that are automatically available in the Helios Context. No additional primitive data needs to be set by the user in most cases.</p>
<table class="doxtable">
<tr>
<th>Primitive Data </th><th>Units </th><th>Data Type </th><th>Description </th><th>Default Value  </th></tr>
<tr>
<td>N/A </td><td>N/A </td><td>N/A </td><td>Plugin uses primitive bounding boxes and UUIDs automatically from Context </td><td>N/A  </td></tr>
</table>
<p><br  />
</p>
<h2><a class="anchor" id="CDOutputData"></a>
Output Primitive Data</h2>
<p>The CollisionDetection plugin does not automatically write output data to primitives. Collision results are returned as vectors of UUIDs that can be processed by the user application as needed.</p>
<table class="doxtable">
<tr>
<th>Primitive Data </th><th>Units </th><th>Data Type </th><th>Description  </th></tr>
<tr>
<td>N/A </td><td>N/A </td><td>N/A </td><td>Collision results returned directly as vectors of UUIDs  </td></tr>
</table>
<h1><a class="anchor" id="CDUse"></a>
Using the Collision Detection Plugin</h1>
<h2><a class="anchor" id="CDConst"></a>
Model Class Constructor</h2>
<p>The collision detection class contains functions and data associated with spatial queries. To begin, declare an instance of the CollisionDetection class. The class constructor takes one argument - a pointer to the Helios context. It uses this pointer to access model geometry and perform collision queries.</p>
<div class="fragment"><div class="line"><a class="code hl_class" href="class_collision_detection.html" title="Class for GPU-accelerated collision detection and spatial queries in Helios.">CollisionDetection</a> collision(&amp;context); <span class="comment">//declare the collision detection system</span></div>
</div><!-- fragment --><h2><a class="anchor" id="CDBasicUsage"></a>
Basic Usage Workflow</h2>
<p>The typical workflow for using the collision detection system is:</p>
<ol type="1">
<li><b>Build the spatial data structure</b> using <a class="el" href="class_collision_detection.html#a885abe5c3788b02384e72329f1b41935">CollisionDetection::buildBVH()</a></li>
<li><b>Query for collisions</b> using <a class="el" href="class_collision_detection.html#a2512277b35d3c68fee5191a63b69cd42">CollisionDetection::findCollisions()</a></li>
<li><b>Process the results</b> as needed by your application</li>
</ol>
<div class="fragment"><div class="line"><span class="comment">// Build the BVH for all primitives in the context</span></div>
<div class="line">collision.buildBVH();</div>
<div class="line"> </div>
<div class="line"><span class="comment">// Find all primitives that collide with a specific primitive</span></div>
<div class="line"><a class="code hl_typedef" href="global_8h.html#a91ad9478d81a7aaf2593e8d9c3d06a14" title="Unsigned integer type.">uint</a> target_UUID = some_primitive_UUID;</div>
<div class="line">std::vector&lt;uint&gt; colliding_UUIDs = collision.findCollisions(target_UUID);</div>
<div class="line"> </div>
<div class="line"><span class="comment">// Process the collision results</span></div>
<div class="line"><span class="keywordflow">for</span>( <a class="code hl_typedef" href="global_8h.html#a91ad9478d81a7aaf2593e8d9c3d06a14" title="Unsigned integer type.">uint</a> UUID : colliding_UUIDs ){</div>
<div class="line">    std::cout &lt;&lt; <span class="stringliteral">&quot;Primitive &quot;</span> &lt;&lt; target_UUID &lt;&lt; <span class="stringliteral">&quot; collides with primitive &quot;</span> &lt;&lt; UUID &lt;&lt; std::endl;</div>
<div class="line">}</div>
</div><!-- fragment --><h2><a class="anchor" id="CDBVH"></a>
Bounding Volume Hierarchy (BVH)</h2>
<p>The collision detection system uses a Bounding Volume Hierarchy (BVH) to efficiently organize primitives in 3D space. The BVH is a binary tree where each node contains an axis-aligned bounding box (AABB), and leaf nodes contain references to actual primitives.</p>
<h3><a class="anchor" id="CDBVHConstruction"></a>
BVH Construction</h3>
<p>The BVH is constructed using the Surface Area Heuristic (SAH) to minimize the expected cost of collision queries. The construction algorithm:</p>
<ul>
<li>Recursively partitions primitives based on the longest axis</li>
<li>Uses median splitting for simplicity and reliability</li>
<li>Stops recursion when reaching ≤8 primitives per leaf or depth ≥20</li>
<li>Optimizes memory layout for GPU cache efficiency</li>
</ul>
<div class="fragment"><div class="line"><span class="comment">// Build BVH for all primitives in the context</span></div>
<div class="line">collision.buildBVH();</div>
<div class="line"> </div>
<div class="line"><span class="comment">// Or build BVH for a specific set of primitives</span></div>
<div class="line">std::vector&lt;uint&gt; specific_UUIDs = {UUID1, UUID2, UUID3};</div>
<div class="line">collision.buildBVH(specific_UUIDs);</div>
</div><!-- fragment --><h3><a class="anchor" id="CDBVHStats"></a>
BVH Statistics and Validation</h3>
<p>You can query statistics about the constructed BVH to understand its structure and validate proper construction:</p>
<div class="fragment"><div class="line"><span class="keywordflow">if</span>( collision.isBVHValid() ){</div>
<div class="line">    <span class="keywordtype">size_t</span> node_count, leaf_count, max_depth;</div>
<div class="line">    collision.getBVHStatistics(node_count, leaf_count, max_depth);</div>
<div class="line">    </div>
<div class="line">    std::cout &lt;&lt; <span class="stringliteral">&quot;BVH contains &quot;</span> &lt;&lt; node_count &lt;&lt; <span class="stringliteral">&quot; total nodes&quot;</span> &lt;&lt; std::endl;</div>
<div class="line">    std::cout &lt;&lt; <span class="stringliteral">&quot;BVH contains &quot;</span> &lt;&lt; leaf_count &lt;&lt; <span class="stringliteral">&quot; leaf nodes&quot;</span> &lt;&lt; std::endl;</div>
<div class="line">    std::cout &lt;&lt; <span class="stringliteral">&quot;BVH maximum depth: &quot;</span> &lt;&lt; max_depth &lt;&lt; std::endl;</div>
<div class="line">    std::cout &lt;&lt; <span class="stringliteral">&quot;Primitive count: &quot;</span> &lt;&lt; collision.getPrimitiveCount() &lt;&lt; std::endl;</div>
<div class="line">}</div>
</div><!-- fragment --><h2><a class="anchor" id="CDCollisionQueries"></a>
Collision Queries</h2>
<p>The plugin supports several types of collision queries:</p>
<h3><a class="anchor" id="CDSinglePrimitive"></a>
Single Primitive Collision</h3>
<p>Find all primitives that have overlapping bounding boxes with a target primitive:</p>
<div class="fragment"><div class="line"><a class="code hl_typedef" href="global_8h.html#a91ad9478d81a7aaf2593e8d9c3d06a14" title="Unsigned integer type.">uint</a> target_UUID = some_primitive_UUID;</div>
<div class="line">std::vector&lt;uint&gt; collisions = collision.findCollisions(target_UUID);</div>
</div><!-- fragment --><h3><a class="anchor" id="CDMultiplePrimitives"></a>
Multiple Primitive Collision</h3>
<p>Find all primitives that collide with any primitive in a set:</p>
<div class="fragment"><div class="line">std::vector&lt;uint&gt; query_UUIDs = {UUID1, UUID2, UUID3};</div>
<div class="line">std::vector&lt;uint&gt; collisions = collision.findCollisions(query_UUIDs);</div>
</div><!-- fragment --><h3><a class="anchor" id="CDObjectCollision"></a>
Object-Based Collision</h3>
<p>Find collisions between primitives and compound objects:</p>
<div class="fragment"><div class="line">std::vector&lt;uint&gt; primitive_UUIDs = {UUID1, UUID2};</div>
<div class="line">std::vector&lt;uint&gt; object_IDs = {objID1, objID2};</div>
<div class="line">std::vector&lt;uint&gt; collisions = collision.findCollisions(primitive_UUIDs, object_IDs);</div>
</div><!-- fragment --><h2><a class="anchor" id="CDGPU"></a>
GPU Acceleration</h2>
<h3><a class="anchor" id="CDGPUEnable"></a>
Enabling/Disabling GPU Acceleration</h3>
<p>By default, GPU acceleration is enabled if CUDA is available. You can control GPU usage:</p>
<div class="fragment"><div class="line"><span class="comment">// Check if GPU acceleration is currently enabled</span></div>
<div class="line"><span class="keywordflow">if</span>( collision.isGPUAccelerationEnabled() ){</div>
<div class="line">    std::cout &lt;&lt; <span class="stringliteral">&quot;GPU acceleration is active&quot;</span> &lt;&lt; std::endl;</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="comment">// Disable GPU acceleration (force CPU mode)</span></div>
<div class="line">collision.disableGPUAcceleration();</div>
<div class="line"> </div>
<div class="line"><span class="comment">// Re-enable GPU acceleration</span></div>
<div class="line">collision.enableGPUAcceleration();</div>
</div><!-- fragment --><h3><a class="anchor" id="CDGPUPerformance"></a>
GPU Performance Considerations</h3>
<p>GPU acceleration provides the most benefit for:</p><ul>
<li>Large scenes with &gt;1000 primitives</li>
<li>Complex collision queries involving many primitives</li>
<li>Repeated collision queries on the same BVH</li>
</ul>
<p>For small scenes (&lt;100 primitives), CPU computation may be faster due to GPU kernel launch overhead.</p>
<h3><a class="anchor" id="CDGPUMemory"></a>
GPU Memory Management</h3>
<p>The plugin automatically manages GPU memory:</p><ul>
<li>GPU memory is allocated when the BVH is built with GPU acceleration enabled</li>
<li>Memory is automatically freed when the BVH is rebuilt or the object is destroyed</li>
<li>The system gracefully handles GPU memory allocation failures by falling back to CPU</li>
</ul>
<div class="fragment"><div class="line"><span class="comment">// Force a rebuild of the BVH (will clean up and reallocate GPU memory)</span></div>
<div class="line">collision.rebuildBVH();</div>
</div><!-- fragment --><h2><a class="anchor" id="CDAdvanced"></a>
Advanced Features</h2>
<h3><a class="anchor" id="CDMessageControl"></a>
Message Control</h3>
<p>You can control diagnostic message output:</p>
<div class="fragment"><div class="line">collision.disableMessages(); <span class="comment">// Suppress diagnostic output</span></div>
<div class="line">collision.enableMessages();  <span class="comment">// Enable diagnostic output (default)</span></div>
</div><!-- fragment --><h3><a class="anchor" id="CDErrorHandling"></a>
Error Handling</h3>
<p>The plugin uses exceptions for error handling. Common errors include:</p>
<div class="fragment"><div class="line"><span class="keywordflow">try</span> {</div>
<div class="line">    <span class="comment">// This will throw an exception if UUID doesn&#39;t exist</span></div>
<div class="line">    std::vector&lt;uint&gt; collisions = collision.findCollisions(invalid_UUID);</div>
<div class="line">} <span class="keywordflow">catch</span>( <span class="keyword">const</span> std::runtime_error&amp; e ) {</div>
<div class="line">    std::cout &lt;&lt; <span class="stringliteral">&quot;Collision detection error: &quot;</span> &lt;&lt; e.what() &lt;&lt; std::endl;</div>
<div class="line">}</div>
</div><!-- fragment --><h3><a class="anchor" id="CDDynamic"></a>
Dynamic Scenes</h3>
<p>For dynamic scenes where geometry changes frequently:</p>
<div class="fragment"><div class="line"><span class="comment">// Add or modify geometry in the context</span></div>
<div class="line">context.addTriangle( make_vec3(0,0,0), make_vec3(1,0,0), make_vec3(0.5,1,0) );</div>
<div class="line"> </div>
<div class="line"><span class="comment">// Rebuild the BVH to include new/modified geometry</span></div>
<div class="line">collision.rebuildBVH();</div>
<div class="line"> </div>
<div class="line"><span class="comment">// Collision queries now include the updated geometry</span></div>
<div class="line">std::vector&lt;uint&gt; collisions = collision.findCollisions(target_UUID);</div>
</div><!-- fragment --><h2><a class="anchor" id="CDPerformance"></a>
Performance Guidelines</h2>
<p>For optimal performance:</p>
<ol type="1">
<li><b>Build BVH once</b>: Avoid rebuilding the BVH unnecessarily as construction can be expensive</li>
<li><b>Batch queries</b>: When possible, query multiple primitives at once rather than individual queries</li>
<li><b>Use GPU acceleration</b>: For large scenes, GPU acceleration can provide 5-20x speedup</li>
<li><b>Monitor memory</b>: Large BVHs can consume significant GPU memory</li>
</ol>
<div class="fragment"><div class="line"><span class="comment">// Good: Build BVH once, perform many queries</span></div>
<div class="line">collision.buildBVH();</div>
<div class="line"><span class="keywordflow">for</span>( <a class="code hl_typedef" href="global_8h.html#a91ad9478d81a7aaf2593e8d9c3d06a14" title="Unsigned integer type.">uint</a> UUID : many_UUIDs ){</div>
<div class="line">    <span class="keyword">auto</span> collisions = collision.findCollisions(UUID);</div>
<div class="line">    <span class="comment">// Process results...</span></div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="comment">// Better: Batch query many UUIDs at once</span></div>
<div class="line">collision.buildBVH();</div>
<div class="line"><span class="keyword">auto</span> all_collisions = collision.findCollisions(many_UUIDs);</div>
</div><!-- fragment --><h1><a class="anchor" id="CDExamples"></a>
Example Applications</h1>
<h2><a class="anchor" id="CDGrowthSim"></a>
Growth Simulation</h2>
<p>Collision detection is commonly used in plant growth simulation to prevent organs from overlapping:</p>
<div class="fragment"><div class="line"><span class="comment">// During growth simulation</span></div>
<div class="line"><a class="code hl_class" href="class_collision_detection.html" title="Class for GPU-accelerated collision detection and spatial queries in Helios.">CollisionDetection</a> collision(&amp;context);</div>
<div class="line">collision.buildBVH();</div>
<div class="line"> </div>
<div class="line"><span class="comment">// Before placing a new leaf</span></div>
<div class="line"><a class="code hl_typedef" href="global_8h.html#a91ad9478d81a7aaf2593e8d9c3d06a14" title="Unsigned integer type.">uint</a> new_leaf_UUID = context.addPatch( leaf_position, leaf_size, leaf_rotation );</div>
<div class="line">std::vector&lt;uint&gt; collisions = collision.findCollisions(new_leaf_UUID);</div>
<div class="line"> </div>
<div class="line"><span class="keywordflow">if</span>( !collisions.empty() ){</div>
<div class="line">    <span class="comment">// Collision detected - adjust leaf position or size</span></div>
<div class="line">    context.deletePrimitive(new_leaf_UUID);</div>
<div class="line">    <span class="comment">// ... implement collision avoidance logic ...</span></div>
<div class="line">}</div>
</div><!-- fragment --><h2><a class="anchor" id="CDSpatialAnalysis"></a>
Spatial Analysis</h2>
<p>Find all primitives within a specific region:</p>
<div class="fragment"><div class="line"><span class="comment">// Create a query region</span></div>
<div class="line"><a class="code hl_typedef" href="global_8h.html#a91ad9478d81a7aaf2593e8d9c3d06a14" title="Unsigned integer type.">uint</a> query_region = context.addBox( region_center, region_size );</div>
<div class="line"> </div>
<div class="line"><span class="comment">// Find all primitives that intersect this region</span></div>
<div class="line">std::vector&lt;uint&gt; intersecting_primitives = collision.findCollisions(query_region);</div>
<div class="line"> </div>
<div class="line"><span class="comment">// Clean up query primitive</span></div>
<div class="line">context.deletePrimitive(query_region);</div>
<div class="line"> </div>
<div class="line"><span class="comment">// Process primitives within the region</span></div>
<div class="line"><span class="keywordflow">for</span>( <a class="code hl_typedef" href="global_8h.html#a91ad9478d81a7aaf2593e8d9c3d06a14" title="Unsigned integer type.">uint</a> UUID : intersecting_primitives ){</div>
<div class="line">    <span class="comment">// ... analyze spatial distribution ...</span></div>
<div class="line">}</div>
</div><!-- fragment --><h1><a class="anchor" id="CDTroubleshooting"></a>
Troubleshooting</h1>
<h2><a class="anchor" id="CDCommonIssues"></a>
Common Issues</h2>
<p>Issue**: Collision detection returns unexpected results</p><ul>
<li><p class="startli"><b>Solution</b>: Ensure the BVH is built after all geometry modifications using <a class="el" href="class_collision_detection.html#a885abe5c3788b02384e72329f1b41935">CollisionDetection::buildBVH()</a> or <a class="el" href="class_collision_detection.html#a1f587d401ee4d895bfe7b6472617df14">CollisionDetection::rebuildBVH()</a></p>
<p class="startli">Issue**: GPU acceleration not working</p>
</li>
<li><p class="startli"><b>Solution</b>: Check that CUDA is properly installed and the GPU has sufficient memory. The system will automatically fall back to CPU if GPU resources are unavailable.</p>
<p class="startli">Issue**: Performance is slower than expected</p>
</li>
<li><p class="startli"><b>Solution</b>: For small scenes, try disabling GPU acceleration. For large scenes, ensure GPU acceleration is enabled and consider batching collision queries.</p>
<p class="startli">Issue**: Memory usage is high</p>
</li>
<li><b>Solution</b>: The BVH requires additional memory proportional to the number of primitives. Consider using fewer primitives or rebuilding the BVH only when necessary.</li>
</ul>
<h2><a class="anchor" id="CDDebugging"></a>
Debugging</h2>
<p>Use the diagnostic functions to understand system behavior:</p>
<div class="fragment"><div class="line">collision.enableMessages(); <span class="comment">// Enable diagnostic output</span></div>
<div class="line"> </div>
<div class="line"><span class="comment">// Check BVH status</span></div>
<div class="line"><span class="keywordflow">if</span>( !collision.isBVHValid() ){</div>
<div class="line">    std::cout &lt;&lt; <span class="stringliteral">&quot;BVH is not valid - call buildBVH() first&quot;</span> &lt;&lt; std::endl;</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="comment">// Check system capabilities  </span></div>
<div class="line"><span class="keywordflow">if</span>( collision.isGPUAccelerationEnabled() ){</div>
<div class="line">    std::cout &lt;&lt; <span class="stringliteral">&quot;GPU acceleration is enabled&quot;</span> &lt;&lt; std::endl;</div>
<div class="line">} <span class="keywordflow">else</span> {</div>
<div class="line">    std::cout &lt;&lt; <span class="stringliteral">&quot;Using CPU-only collision detection&quot;</span> &lt;&lt; std::endl;</div>
<div class="line">}</div>
</div><!-- fragment --> </div></div><!-- contents -->
</div><!-- PageDoc -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.13.2 </li>
  </ul>
</div>
</body>
</html>
