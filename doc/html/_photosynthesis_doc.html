<!-- HTML header for doxygen 1.12.0-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.13.2"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Helios: Photosynthesis Model Plugin Documentation</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/javascript" src="clipboard.js"></script>
<script type="text/javascript" src="doxygen-awesome-darkmode-toggle.js"></script>
<script type="text/javascript" src="doxygen-awesome-paragraph_link.js"></script>
<script type="text/javascript" src="doxygen-awesome-tabs.js"></script>
<script type="text/javascript" src="doxygen-awesome-interactive-toc.js"></script>
<script type="text/javascript">
  DoxygenAwesomeDarkModeToggle.init()
  DoxygenAwesomeParagraphLink.init()
  DoxygenAwesomeTabs.init()
  DoxygenAwesomeInteractiveToc.init()
</script>
<script>
    try {
        // Remove the stored “last visited page” so the tree always starts fresh
        Cookie.eraseSetting('navpath');
        localStorage.removeItem('navpath');
        // Older Doxygen versions might use this key:
        localStorage.removeItem('nav-sync-path');
        // Force panel synchronization on by default
        localStorage.setItem('navsync', 'true');
        // (fallback for some older builds)
        localStorage.setItem('nav-sync', 'true');
    } catch(e) {
        /* storage unavailable? ignore */
    }
</script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="cookie.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
  $(function() { init_search(); });
/* @license-end */
</script>
<script type="text/javascript">
window.MathJax = {
  options: {
    ignoreHtmlClass: 'tex2jax_ignore',
    processHtmlClass: 'tex2jax_process'
  }
};
</script>
<script type="text/javascript" id="MathJax-script" async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js"></script>
<link href="doxygen-awesome.css" rel="stylesheet" type="text/css" />
<link href="doxygen-awesome-sidebar-only-darkmode-toggle.css" rel="stylesheet" type="text/css"/>
<link href="custom.css" rel="stylesheet" type="text/css"/>
</head>
<!-- Google tag (gtag.js) -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-93BB4673PE"></script>
<script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());
    gtag('config', 'G-93BB4673PE');
</script>
<!-- Google tag (gtag.js) -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-3F0Y5Z6543"></script>
<script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());
    gtag('config', 'G-3F0Y5Z6543');
</script>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="5">
 <tbody>
 <tr id="projectrow">
  <td id="projectlogo"><img alt="Logo" src="Helios_logo_small.png"></td>
  <td id="projectalign">
   <div id="projectname">
       <span id="projectnumber">&#160;v1.3.37</span>
   </div>
  </td>
     <td id="searchbox-container">        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <span id="MSearchSelect"                onmouseover="return searchBox.OnSearchSelectShow()"                onmouseout="return searchBox.OnSearchSelectHide()">&#160;</span>
          <input type="text" id="MSearchField" value="" placeholder="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.svg" alt=""/></a>
          </span>
        </div>
</td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.13.2 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() { codefold.init(0); });
/* @license-end */
</script>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function(){initNavTree('_photosynthesis_doc.html',''); initResizable(true); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div><div class="header">
  <div class="headertitle"><div class="title">Photosynthesis Model Plugin Documentation</div></div>
</div><!--header-->
<div class="contents">
<div class="toc"><h3>Table of Contents</h3>
<ul>
  <li class="level1">
    <a href="#PhotoConstructor">Class Constructor</a>
  </li>
  <li class="level1">
    <a href="#PhotoVarsAndProps">Primitive Data</a>
    <ul>
      <li class="level2">
        <a href="#PhotoInputData">Input Primitive Data</a>
      </li>
      <li class="level2">
        <a href="#PhotoOutputData">Default Output Primitive Data</a>
      </li>
      <li class="level2">
        <a href="#PhotoOptionalOutputData">Optional Output Primitive Data</a>
      </li>
    </ul>
  </li>
  <li class="level1">
    <a href="#PhotoDescription">Introduction</a>
  </li>
  <li class="level1">
    <a href="#FarquharDescription">Farquhar, von Caemmerer, Berry Model Description</a>
    <ul>
      <li class="level2">
        <a href="#FvCBtemperature">Temperature response of model parameters</a>
        <ul>
          <li class="level3">
            <a href="#FvCBPhotoVars">Summary of FvCB Model Independent Variables</a>
          </li>
          <li class="level3">
            <a href="#FvCBPhotoParams">Summary of FvCB Model Parameters</a>
          </li>
          <li class="level3">
            <a href="#FvCBSettingPhotoParams">Setting FvCB Model Parameters</a>
          </li>
        </ul>
      </li>
    </ul>
  </li>
  <li class="level1">
    <a href="#EmpiricalDescription">Empirical Model Description</a>
    <ul>
      <li class="level2">
        <a href="#LightResponse">Light Response Function</a>
      </li>
      <li class="level2">
        <a href="#TempResponse">Temperature Response</a>
      </li>
      <li class="level2">
        <a href="#CO2Response">CO2 Response Function</a>
      </li>
      <li class="level2">
        <a href="#Ci">Intercellular CO2 Concentration</a>
      </li>
      <li class="level2">
        <a href="#PhotoCalib">Empirical Model Calibration Procedure</a>
        <ul>
          <li class="level3">
            <a href="#PhotoVars">Summary of Empirical Model Independent Variables</a>
          </li>
          <li class="level3">
            <a href="#PhotoParams">Summary of Empirical Model Parameters</a>
          </li>
          <li class="level3">
            <a href="#PhotoLightParam">Response of Assimilation Rate to Light</a>
          </li>
          <li class="level3">
            <a href="#PhotoTempParam">Response of Assimilation Rate to Temperature</a>
          </li>
          <li class="level3">
            <a href="#PhotoRespParam">Response of Respiration Rate to Temperature</a>
          </li>
          <li class="level3">
            <a href="#PhotoCO2Param">Response of Assimilation Rate to CO2</a>
          </li>
        </ul>
      </li>
    </ul>
  </li>
</ul>
</div>
<div class="textblock"><table class="doxtable">
<tr>
<th>Dependencies</th><td>None </td></tr>
<tr>
<th>CMakeLists.txt</th><td>set( PLUGINS "photosynthesis" ) </td></tr>
<tr>
<th>Header File</th><td>include "PhotosynthesisModel.h" </td></tr>
<tr>
<th>Class</th><td><a class="el" href="class_photosynthesis_model.html">PhotosynthesisModel</a> </td></tr>
</table>
<h1><a class="anchor" id="PhotoConstructor"></a>
Class Constructor</h1>
<table class="doxtable">
<tr>
<th>Constructors </th></tr>
<tr>
<td><a class="el" href="class_photosynthesis_model.html">PhotosynthesisModel( helios::Context* )</a> </td></tr>
</table>
<h1><a class="anchor" id="PhotoVarsAndProps"></a>
Primitive Data</h1>
<h2><a class="anchor" id="PhotoInputData"></a>
Input Primitive Data</h2>
<table class="doxtable">
<tr>
<th>Primitive Data Label</th><th>Symbol</th><th>Units</th><th>Data Type</th><th>Description</th><th>Available Plug-ins</th><th>Default Value </th></tr>
<tr>
<td>radiation_flux_PAR</td><td>\(Q\)</td><td>W/m<sup>2</sup></td><td> <font face="courier" color="green">float</font></td><td>Radiative flux in PAR band. NOTE: this is automatically converted to units of photon flux density, which are the units used in the photosynthesis model.</td><td>Can be computed by <a class="el" href="class_radiation_model.html">RadiationModel</a> plug-in.</td><td>0 </td></tr>
<tr>
<td>temperature</td><td>\(T_s\)</td><td>Kelvin</td><td> <font face="courier" color="green">float</font></td><td>Primitive surface temperature.</td><td>Can be computed by <a class="el" href="class_energy_balance_model.html">EnergyBalanceModel</a> plug-in.</td><td>300 K </td></tr>
<tr>
<td>air_CO2</td><td>\(C_a\)</td><td>\(\mu\)mol CO<sub>2</sub>/mol air</td><td> <font face="courier" color="green">float</font></td><td>CO<sub>2</sub> concentration of air outside of primitive boundary-layer.</td><td>N/A</td><td>390 \(\mu\)mol/mol </td></tr>
<tr>
<td>moisture_conductance</td><td>\(g_S\)</td><td>mol air/m<sup>2</sup>-s</td><td> <font face="courier" color="green">float</font></td><td>Conductance to moisture between sub-stomatal cells and leaf surface (i.e., stomatal conductance).</td><td>Can be computed by <a class="el" href="class_stomatal_conductance_model.html">StomatalConductanceModel</a> plug-in.</td><td>0.25 mol/m<sup>2</sup>-s </td></tr>
<tr>
<td>boundarylayer_conductance**</td><td>\(g_H\)</td><td>mol air/m<sup>2</sup>-s</td><td> <font face="courier" color="green">float</font></td><td>Conductance to heat between leaf surface and outside of the boundary-layer (i.e., boundary-layer conductance).</td><td>Can be computed by <a class="el" href="class_b_l_conductance_model.html">BLConductanceModel</a> plug-in, or by <a class="el" href="class_energy_balance_model.html">EnergyBalanceModel</a> plug-in if optional output primitive data "boundarylayer_conductance_out" is enabled.</td><td>1.0 mol/m<sup>2</sup>-s </td></tr>
<tr>
<td>twosided_flag </td><td>N/A </td><td>N/A </td><td> <font face="courier" color="green">uint</font> </td><td>Flag indicating the number of primitive faces with heat transfer (twosided_flag = 0 for one-sided heat transfer; twosided_flag = 1 for two-sided heat transfer). </td><td>N/A </td><td>1  </td></tr>
<tr>
<td>stomatal_sidedness </td><td>\(\zeta\) </td><td>unitless </td><td> <font face="courier" color="green">float</font> </td><td>Ratio of stomatal density on the upper leaf surface to the sum of the stomatal density on upper and lower leaf surfaces. Note: if "twosided_flag" is equal to 0, stomatal_sidedness will be automatically set to 0.</td><td>N/A </td><td>0  </td></tr>
</table>
<p>**The photosynthesis model will also check for primitive data "boundarylayer_conductance_out" if "boundarylayer_conductance" does not exist. If you are using the energy balance model to calculate the boundary-layer conductance, you should enable optional output primitive data "boundarylayer_conductance_out" so that other plug-ins can use it.</p>
<h2><a class="anchor" id="PhotoOutputData"></a>
Default Output Primitive Data</h2>
<table class="doxtable">
<tr>
<th>Primitive Data Label</th><th>Symbol</th><th>Units</th><th>Data Type</th><th>Description</th></tr>
<tr>
<td>net_photosynthesis</td><td>\(A\)</td><td>\(\mu\)mol CO<sub>2</sub>/m<sup>2</sup>-sec</td><td> <font face="courier" color="green">float</font></td><td>Net rate of carbon transfer per unit one-sided area. </td></tr>
</table>
<h2><a class="anchor" id="PhotoOptionalOutputData"></a>
Optional Output Primitive Data</h2>
<table class="doxtable">
<tr>
<th>Primitive Data Label</th><th>Symbol</th><th>Units</th><th>Data Type</th><th>Description </th></tr>
<tr>
<td>Ci</td><td>\(C_i\)</td><td>\(\mu\)mol CO<sub>2</sub>/mol</td><td> <font face="courier" color="green">float</font></td><td>Intercellular CO<sub>2</sub> concentration. </td></tr>
<tr>
<td>Gamma_CO2</td><td>\(\Gamma\)</td><td>\(\mu\)mol CO<sub>2</sub>/mol</td><td> <font face="courier" color="green">float</font></td><td>Photosynthetic CO<sub>2</sub> compensation point (including "dark respiration"). </td></tr>
<tr>
<td>limitation_state</td><td>N/A</td><td>N/A</td><td> <font face="courier" color="green">int</font></td><td>Photosynthesis limitation state. limitation_state=0 if photosynthesis is Rubisco-limited, limitation_state=1 if photosynthesis is electron transport limited. </td></tr>
</table>
<h1><a class="anchor" id="PhotoDescription"></a>
Introduction</h1>
<p>The photosynthesis plug-in implements two types of models: the biochemical model of <a href="https://link.springer.com/article/10.1007/BF00386231">Farquhar, von Caemmerer, and Berry (1980)</a>, and an empirical model similar to that of <a href="../../plugins/photosynthesis/doc/Johnson_2010_PlantMod.pdf">Johnson (2010)</a>, which are described separately below.</p>
<p>By default, the plug-in uses the biochemical model. The model can either be set explicitly, as illustrated in the code below, or the model type will be inferred based on the model coefficients that are set (see descriptions below).</p>
<div class="fragment"><div class="line"><span class="preprocessor">#include &quot;<a class="code" href="_photosynthesis_model_8h.html">PhotosynthesisModel.h</a>&quot;</span></div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">int</span> main(){</div>
<div class="line">  <a class="code hl_class" href="class_photosynthesis_model.html">PhotosynthesisModel</a> photosynthesismodel(&amp;context);</div>
<div class="line"> </div>
<div class="line">  <span class="comment">//Use the Farquahar-von Caemmerer-Berry model</span></div>
<div class="line">  photosynthesismodel.setModelType_Farquhar();</div>
<div class="line"> </div>
<div class="line">  photosynthesismodel.run();</div>
<div class="line"> </div>
<div class="line">  <span class="comment">//Switch back to the empirical model</span></div>
<div class="line">  photosynthesismodel.setModelType_Empirical();</div>
<div class="line">}</div>
</div><!-- fragment --><h1><a class="anchor" id="FarquharDescription"></a>
Farquhar, von Caemmerer, Berry Model Description</h1>
<p>The model of <a href="https://link.springer.com/article/10.1007/BF00386231">Farquhar, von Caemmerer, and Berry (1980)</a> is a biochemical model of photosynthesis. The form used here predicts photosynthetic production as a function of photoshynthetically active radiation flux, ambient CO<sub>2</sub> concentration, and stomatal conductance, which may itself provide responses to a number of additional environmental variables.</p>
<p>The implementation used here calculates the net rate of CO<sub>2</sub> exchange as</p>
<p class="formulaDsp">
\[A=\left(1-\frac{\Gamma^*}{C_i}\right)\mathrm{min}\left\{W_c,W_j,W_p\right\}-R_d,\]
</p>
<p>where</p>
<p class="formulaDsp">
\[W_c=\frac{V_{cmax}C_i}{C_i+K_{co}}\]
</p>
<p>is the rate limited by Rubisco, with</p>
<p class="formulaDsp">
\[K_{co}=K_c\left(1+\frac{O}{K_O}\right),\]
</p>
<p>where \(O\) is oxygen concentration.</p>
<p class="formulaDsp">
\[W_j=\dfrac{J C_i}{4C_i+8\Gamma^*}\]
</p>
<p>is the rate limited by RuBP regeneration.</p>
<p>The light response of \(J\), the potential electron transport rate, can be described as a rectangular hyperbola with 1 shape parameter, or non-rectangular hyperbola with 2 shape parameters. The rectangular hyperbola takes the form</p>
<p class="formulaDsp">
\[ J(Q) = \dfrac{J_{max} \alpha Q}{\alpha Q + J_{max}} \]
</p>
<p>where \(Q\) is the photosynthetically active absorbed radiation flux ( \(\mu mol\,m^{-2}\,s^{-1}\)), \(J_{max}\) is the temperature-dependent maximum potential electron transport rate ( \(\mu mol\,m^{-2}\,s^{-1}\)), and \(\alpha\) is the intrinsic quantum efficiency of electron transport ( \(electron\,photon^{-1}\)) which defines the initial slope of the light response, determines its resulting shape in the rectangular hyperbolic form, and is thought to be relatively conserved around 0.5. The non-rectangular hyperbola takes the form</p>
<p class="formulaDsp">
\[J(Q) = \dfrac{\alpha Q + J_{max} - \sqrt{(\alpha Q + J_{max})^2 - 4 \theta \alpha Q J_{max}}}{2 \theta}\]
</p>
<p>where \(\theta\) is an additional parameter (unitless) that shapes the light response curve beyond its initial slope. When \(\theta\) approaches zero, the two forms become equivalent. In Photosynthesis Plugin, the rectangular form will be assumed unless \(\theta\) is specified by the user.</p>
<p class="formulaDsp">
\[W_p=\dfrac{3\,TPU\,C_i}{C_i-\Gamma^*}\]
</p>
<p>is the rate limited by triose phosphate utilization. Note that if the TPU parameter is not set by the user, this state is ignored.</p>
<p>The intercellular CO<sub>2</sub> concentration \(C_i\) is determined from the relation</p>
<p>\(A=0.75g_M\left(C_{a}-C_i\right)\)</p>
<p>which is solved numerically using the Secant method, since \(A\) is a complex nonlinear function of \(C_i\) which prevents an analytical solution for \(C_i\). The 0.75 factor comes from the fact that diffusion of CO<sub>2</sub> in air is slower than that of water vapor (see Eq. 7.33 of <a href="http://www.springer.com/us/book/9780387949376#otherversion=9781461216261">Campbell and Norman</a>).</p>
<p>\(g_M\) is the conductance to moisture transfer between the leaf interior and just outside of the leaf boundary-layer, and is calculated as</p>
<p>\(g_M = 1.08g_Hg_S\left[\dfrac{\zeta}{1.08g_H+g_S\zeta}+\dfrac{(1-\zeta)}{1.08g_H+g_S(1-\zeta)}\right]\),</p>
<p>where \(g_H\) is the boundary-layer conductance to heat, and \(1.08g_H\) gives the boundary-layer conductance to moisture considering the differences in diffusivity between water vapor and heat. \(n_s\) is the number of primitive faces, which is determined by the value of primitive data "twosided_flag" (twosided_flag=0 is single-sided and \(n_s=1\), twosided_flag=1 is two-sided and \(n_s=2\)).</p>
<p>\(\zeta=\dfrac{D_{upper}}{D_{lower}+D_{upper}}\)</p>
<p>is the stomatal sidedness, which is the ratio of the stomatal density of the upper leaf surface to the sum of the upper and lower leaf surface densities, which is set by the primitive data value "stomatal_sidedness". For leaves, \(\zeta=0\) corresponds to hypostomatous leaves (stomata on one side), and \(\zeta=0.5\) to amphistomatous leaves (stomata equally on both sides). It is important to note that if \(n_s=1\), then the value of \(\zeta\) will be overridden and set to 0.</p>
<h2><a class="anchor" id="FvCBtemperature"></a>
Temperature response of model parameters</h2>
<p>Two different temperature response functions are commonly used in photosynthetic modeling and supported in the Photosynthesis Plugin. One is an Arrhenius equation, which is exponentially increasing with no decline in the region of use. The other is a modified Arrhenius equation with a peak or temperature optimum, beyond which there is a decline in the value of the function, representing a denaturing of an enzyme and subsequent reduction of its activity.</p>
<p class="formulaDsp">
\[ \begin{aligned}
 k &amp;= k_{25} \cdot \exp \left[\frac{\Delta H_a}{R} \left(\frac{1}{298}-\frac{1}{T_{leaf}} \right) \right] \frac{f(298)}{f(T_{leaf})}, \\
 f(T_{leaf}) &amp;= 1+\exp \left[\frac{\Delta H_d}{R} \left(\frac{1}{T_{opt}} - \frac{1}{T_{leaf}} \right) - \ln \left(\frac{\Delta H_d}{\Delta H_a}-1 \right) \right]
 \end{aligned}
\]
</p>
<p>In this form, the model is conveniently parameterized by the commonly used standard reference rate at 25 \(^\circ\)C, \(k_{25}\), as well as the energy of activation, \(A = \Delta H_a = dH_a\) of the Arrhenius equation, but also by the observable temperature optimum, \(T_{opt}\) and one additional fitted parameter, the energy of deactivation, \(D = \Delta H _d = dH_d\), related to the rate of decline from the optimum.</p>
<p>As \(T_{opt}\) \(\to \infty\), then the peaked form approaches the standard, unpeaked Arrhenius equation, allowing for mathematical backwards compatibility for parameters obtained from fitting to the standard unpeaked form.</p>
<p>In the Photosynthesis Plugin, the Arrhenius form will be assumed as it requires fewer parameters, unless the additional parameters \(dH_d\) and \(T_{opt}\) are specified by the user.</p>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">Parameter   </th><th class="markdownTableHeadNone">Description   </th><th class="markdownTableHeadNone">Units    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">\(k_{25}\)   </td><td class="markdownTableBodyNone">reference rate at 25 \(^\circ\)C   </td><td class="markdownTableBodyNone">\(\mu mol\,m^{-2}\,s^{-1}\)    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">\(dH_a\)   </td><td class="markdownTableBodyNone">activation energy (rate of increase)   </td><td class="markdownTableBodyNone">\(kJ\,mol^{-1}\)    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">\(dH_d\)   </td><td class="markdownTableBodyNone">deactivation energy (rate of decrease)   </td><td class="markdownTableBodyNone">\(kJ\,mol^{-1}\)    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">\(T_{opt}\)   </td><td class="markdownTableBodyNone">optimum temperature in Kelvin   </td><td class="markdownTableBodyNone">\(K\)    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">\(T_{leaf}\)   </td><td class="markdownTableBodyNone">leaf surface temperature in Kelvin   </td><td class="markdownTableBodyNone">\(K\)    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">\(R\)   </td><td class="markdownTableBodyNone">ideal gas constant, 0.008314   </td><td class="markdownTableBodyNone">\(kJ\,mol^{-1}\,K^{-1}\)   </td></tr>
</table>
<p>Additional temperature parameters that are not typically fit to use the standard Arrhenius form with the parameters obtained by <a href="https://onlinelibrary.wiley.com/doi/full/10.1111/j.1365-3040.2001.00668.x">Bernacchi et al. (2001)</a>, and are given by the following equations</p>
<p class="formulaDsp">
\[ \begin{aligned}
 \Gamma^* &amp;= 42.60 \cdot \exp \left[ \frac{37.83}{R} \left(\frac{1}{298} - \frac{1}{T_{leaf}} \right) \right] \\
 K_c &amp;= 400.3 \cdot \exp \left[ \frac{79.43}{R} \left(\frac{1}{298} - \frac{1}{T_{leaf}} \right) \right] \\
 K_o &amp;= 275.1 \cdot \exp \left[ \frac{36.38}{R} \left(\frac{1}{298} - \frac{1}{T_{leaf}} \right) \right] \\
 R_d &amp;= R_{d,25} \cdot \exp \left[ \frac{46.39}{R} \left(\frac{1}{298} - \frac{1}{T_{leaf}} \right) \right]
 \end{aligned}
\]
</p>
<h3><a class="anchor" id="FvCBPhotoVars"></a>
Summary of FvCB Model Independent Variables</h3>
<table class="doxtable">
<tr>
<th>Variable</th><th>Units</th><th>Description </th></tr>
<tr>
<td>\(Q\)</td><td>\(\mu\)mol/m<sup>2</sup>-sec.</td><td>Photosynthetic radiation energy flux. </td></tr>
<tr>
<td>\(T_s\)</td><td>Kelvin</td><td>Surface temperature. </td></tr>
<tr>
<td>\(C_{a}\)</td><td>\(\mu\)mol CO<sub>2</sub>/mol air</td><td>Ambient CO<sub>2</sub> concentration outside of boundary-layer. </td></tr>
<tr>
<td>\(g_M\)</td><td>mol air/m<sup>2</sup>-s</td><td>Conductance to moisture transfer between inside the leaf and leaf surface (i.e., stomatal conductance). </td></tr>
<tr>
<td>\(g_H\)</td><td>mol air/m<sup>2</sup>-s</td><td>Conductance to heat transfer between the leaf surface and outside the boundary-layer (i.e., boundary-layer conductance). </td></tr>
</table>
<h3><a class="anchor" id="FvCBPhotoParams"></a>
Summary of FvCB Model Parameters</h3>
<p>The table below gives example model parameters obtained for several different species. These parameters were fit from leaf-level gas exchange data using the <a href="https://github.com/GEMINI-Breeding/photorch">PhoTorch</a> Python package. Note that the parameter sets are based on different temperature response functions depending on the data that was available.</p>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">Species   </th><th class="markdownTableHeadNone">\(V_{cmax25}\)   </th><th class="markdownTableHeadNone">\(J_{max25}\)   </th><th class="markdownTableHeadNone">\(TPU_{25}\)   </th><th class="markdownTableHeadNone">\(R_{d25}\)   </th><th class="markdownTableHeadNone">\(\alpha\)   </th><th class="markdownTableHeadNone">\(\theta\)   </th><th class="markdownTableHeadNone">\(\Delta H_{a,Vcmax}\)   </th><th class="markdownTableHeadNone">\(T _{opt,Vcmax}\)   </th><th class="markdownTableHeadNone">\(\Delta H_{d,Vcmax}\)   </th><th class="markdownTableHeadNone">\(\Delta H_{a,Jmax}\)   </th><th class="markdownTableHeadNone">\(T _{opt,Jmax}\)   </th><th class="markdownTableHeadNone">\(\Delta H_{d,Jmax}\)   </th><th class="markdownTableHeadNone">\(\Delta H_{a,TPU}\)   </th><th class="markdownTableHeadNone">\(T _{opt,TPU}\)   </th><th class="markdownTableHeadNone">\(\Delta H_{d,TPU}\)    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">Almond   </td><td class="markdownTableBodyNone">72.6   </td><td class="markdownTableBodyNone">144.2   </td><td class="markdownTableBodyNone">6.4   </td><td class="markdownTableBodyNone">0.2   </td><td class="markdownTableBodyNone">0.094   </td><td class="markdownTableBodyNone">0   </td><td class="markdownTableBodyNone">27.3   </td><td class="markdownTableBodyNone">315.3   </td><td class="markdownTableBodyNone">478.4   </td><td class="markdownTableBodyNone">64.1   </td><td class="markdownTableBodyNone">314.9   </td><td class="markdownTableBodyNone">508.4   </td><td class="markdownTableBodyNone">37.1   </td><td class="markdownTableBodyNone">311.3   </td><td class="markdownTableBodyNone">477.9    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">California Bay   </td><td class="markdownTableBodyNone">97.5   </td><td class="markdownTableBodyNone">193   </td><td class="markdownTableBodyNone">3.3   </td><td class="markdownTableBodyNone">0.1   </td><td class="markdownTableBodyNone">0.037   </td><td class="markdownTableBodyNone">0   </td><td class="markdownTableBodyNone">49.1   </td><td class="markdownTableBodyNone">308.6   </td><td class="markdownTableBodyNone">505.8   </td><td class="markdownTableBodyNone">34   </td><td class="markdownTableBodyNone">308.5   </td><td class="markdownTableBodyNone">456.7   </td><td class="markdownTableBodyNone">0.1   </td><td class="markdownTableBodyNone">309.4   </td><td class="markdownTableBodyNone">477.5    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">Elderberry   </td><td class="markdownTableBodyNone">37.7   </td><td class="markdownTableBodyNone">149.7   </td><td class="markdownTableBodyNone">7.3   </td><td class="markdownTableBodyNone">1.3   </td><td class="markdownTableBodyNone">0.202   </td><td class="markdownTableBodyNone">0.472   </td><td class="markdownTableBodyNone">66   </td><td class="markdownTableBodyNone">319.4   </td><td class="markdownTableBodyNone">496   </td><td class="markdownTableBodyNone">24.5   </td><td class="markdownTableBodyNone">314.8   </td><td class="markdownTableBodyNone">492.9   </td><td class="markdownTableBodyNone">33.6   </td><td class="markdownTableBodyNone">314.5   </td><td class="markdownTableBodyNone">497.5    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">Grape   </td><td class="markdownTableBodyNone">74.5   </td><td class="markdownTableBodyNone">180.2   </td><td class="markdownTableBodyNone">7.7   </td><td class="markdownTableBodyNone">1.3   </td><td class="markdownTableBodyNone">0.304   </td><td class="markdownTableBodyNone">0   </td><td class="markdownTableBodyNone">76.1   </td><td class="markdownTableBodyNone">318.8   </td><td class="markdownTableBodyNone">499.8   </td><td class="markdownTableBodyNone">23   </td><td class="markdownTableBodyNone">313.8   </td><td class="markdownTableBodyNone">502.3   </td><td class="markdownTableBodyNone">24   </td><td class="markdownTableBodyNone">314.6   </td><td class="markdownTableBodyNone">496.4    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">Maple   </td><td class="markdownTableBodyNone">96.4   </td><td class="markdownTableBodyNone">168   </td><td class="markdownTableBodyNone">2.7   </td><td class="markdownTableBodyNone">0.1   </td><td class="markdownTableBodyNone">0.077   </td><td class="markdownTableBodyNone">0   </td><td class="markdownTableBodyNone">48.9   </td><td class="markdownTableBodyNone">307.1   </td><td class="markdownTableBodyNone">505   </td><td class="markdownTableBodyNone">8.5   </td><td class="markdownTableBodyNone">304.7   </td><td class="markdownTableBodyNone">476.7   </td><td class="markdownTableBodyNone">32.1   </td><td class="markdownTableBodyNone">308.3   </td><td class="markdownTableBodyNone">471.6    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">Olive   </td><td class="markdownTableBodyNone">75.9   </td><td class="markdownTableBodyNone">170.4   </td><td class="markdownTableBodyNone">8.3   </td><td class="markdownTableBodyNone">1.9   </td><td class="markdownTableBodyNone">0.398   </td><td class="markdownTableBodyNone">0   </td><td class="markdownTableBodyNone">55.4   </td><td class="markdownTableBodyNone">315.2   </td><td class="markdownTableBodyNone">497   </td><td class="markdownTableBodyNone">32.2   </td><td class="markdownTableBodyNone">312.5   </td><td class="markdownTableBodyNone">493.4   </td><td class="markdownTableBodyNone">37.2   </td><td class="markdownTableBodyNone">311.7   </td><td class="markdownTableBodyNone">498.9    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">Pistachio   </td><td class="markdownTableBodyNone">101.8   </td><td class="markdownTableBodyNone">223   </td><td class="markdownTableBodyNone">9.8   </td><td class="markdownTableBodyNone">1.5   </td><td class="markdownTableBodyNone">0.216   </td><td class="markdownTableBodyNone">0.65   </td><td class="markdownTableBodyNone">56.5   </td><td class="markdownTableBodyNone">316.6   </td><td class="markdownTableBodyNone">483.1   </td><td class="markdownTableBodyNone">27.7   </td><td class="markdownTableBodyNone">314.6   </td><td class="markdownTableBodyNone">458.5   </td><td class="markdownTableBodyNone">39.9   </td><td class="markdownTableBodyNone">315.4   </td><td class="markdownTableBodyNone">494.3    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">Toyon   </td><td class="markdownTableBodyNone">52.8   </td><td class="markdownTableBodyNone">142.4   </td><td class="markdownTableBodyNone">6.6   </td><td class="markdownTableBodyNone">0.8   </td><td class="markdownTableBodyNone">0.29   </td><td class="markdownTableBodyNone">0.532   </td><td class="markdownTableBodyNone">42.1   </td><td class="markdownTableBodyNone">315.1   </td><td class="markdownTableBodyNone">483   </td><td class="markdownTableBodyNone">9   </td><td class="markdownTableBodyNone">313   </td><td class="markdownTableBodyNone">486.2   </td><td class="markdownTableBodyNone">14   </td><td class="markdownTableBodyNone">314.8   </td><td class="markdownTableBodyNone">493.8    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">Walnut   </td><td class="markdownTableBodyNone">81.6   </td><td class="markdownTableBodyNone">201.9   </td><td class="markdownTableBodyNone">10.2   </td><td class="markdownTableBodyNone">0.9   </td><td class="markdownTableBodyNone">0.362   </td><td class="markdownTableBodyNone">0   </td><td class="markdownTableBodyNone">85.3   </td><td class="markdownTableBodyNone">316.5   </td><td class="markdownTableBodyNone">500.6   </td><td class="markdownTableBodyNone">41.4   </td><td class="markdownTableBodyNone">308.6   </td><td class="markdownTableBodyNone">308.2   </td><td class="markdownTableBodyNone">21.9   </td><td class="markdownTableBodyNone">310.4   </td><td class="markdownTableBodyNone">434.9    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">Redbud   </td><td class="markdownTableBodyNone">68.5   </td><td class="markdownTableBodyNone">132.4   </td><td class="markdownTableBodyNone">6.6   </td><td class="markdownTableBodyNone">0.8   </td><td class="markdownTableBodyNone">0.41   </td><td class="markdownTableBodyNone">0   </td><td class="markdownTableBodyNone">66.6   </td><td class="markdownTableBodyNone">315.1   </td><td class="markdownTableBodyNone">496   </td><td class="markdownTableBodyNone">41.2   </td><td class="markdownTableBodyNone">313.1   </td><td class="markdownTableBodyNone">474   </td><td class="markdownTableBodyNone">34.3   </td><td class="markdownTableBodyNone">312.8   </td><td class="markdownTableBodyNone">463.2    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">Apple   </td><td class="markdownTableBodyNone">101.08   </td><td class="markdownTableBodyNone">167.03   </td><td class="markdownTableBodyNone">&ndash;   </td><td class="markdownTableBodyNone">3.00   </td><td class="markdownTableBodyNone">0.432   </td><td class="markdownTableBodyNone">0   </td><td class="markdownTableBodyNone">65.33   </td><td class="markdownTableBodyNone">&ndash;   </td><td class="markdownTableBodyNone">&ndash;   </td><td class="markdownTableBodyNone">47.62   </td><td class="markdownTableBodyNone">&ndash;   </td><td class="markdownTableBodyNone">&ndash;   </td><td class="markdownTableBodyNone">&ndash;   </td><td class="markdownTableBodyNone">&ndash;   </td><td class="markdownTableBodyNone">&ndash;    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">Cherry   </td><td class="markdownTableBodyNone">75.65   </td><td class="markdownTableBodyNone">129.06   </td><td class="markdownTableBodyNone">&ndash;   </td><td class="markdownTableBodyNone">2.12   </td><td class="markdownTableBodyNone">0.404   </td><td class="markdownTableBodyNone">0   </td><td class="markdownTableBodyNone">65.33   </td><td class="markdownTableBodyNone">&ndash;   </td><td class="markdownTableBodyNone">&ndash;   </td><td class="markdownTableBodyNone">48.49   </td><td class="markdownTableBodyNone">&ndash;   </td><td class="markdownTableBodyNone">&ndash;   </td><td class="markdownTableBodyNone">&ndash;   </td><td class="markdownTableBodyNone">&ndash;   </td><td class="markdownTableBodyNone">&ndash;    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">Pear   </td><td class="markdownTableBodyNone">107.69   </td><td class="markdownTableBodyNone">176.71   </td><td class="markdownTableBodyNone">&ndash;   </td><td class="markdownTableBodyNone">1.51   </td><td class="markdownTableBodyNone">0.274   </td><td class="markdownTableBodyNone">0   </td><td class="markdownTableBodyNone">65.33   </td><td class="markdownTableBodyNone">&ndash;   </td><td class="markdownTableBodyNone">&ndash;   </td><td class="markdownTableBodyNone">46.04   </td><td class="markdownTableBodyNone">&ndash;   </td><td class="markdownTableBodyNone">&ndash;   </td><td class="markdownTableBodyNone">&ndash;   </td><td class="markdownTableBodyNone">&ndash;   </td><td class="markdownTableBodyNone">&ndash;    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">Prune   </td><td class="markdownTableBodyNone">75.88   </td><td class="markdownTableBodyNone">129.41   </td><td class="markdownTableBodyNone">&ndash;   </td><td class="markdownTableBodyNone">1.65   </td><td class="markdownTableBodyNone">0.402   </td><td class="markdownTableBodyNone">0   </td><td class="markdownTableBodyNone">65.33   </td><td class="markdownTableBodyNone">&ndash;   </td><td class="markdownTableBodyNone">&ndash;   </td><td class="markdownTableBodyNone">48.58   </td><td class="markdownTableBodyNone">&ndash;   </td><td class="markdownTableBodyNone">&ndash;   </td><td class="markdownTableBodyNone">&ndash;   </td><td class="markdownTableBodyNone">&ndash;   </td><td class="markdownTableBodyNone">&ndash;   </td></tr>
</table>
<h3><a class="anchor" id="FvCBSettingPhotoParams"></a>
Setting FvCB Model Parameters</h3>
<p>The model coefficients can be set manually or by using the library of coefficients provided in the table above.</p>
<p>To load the FvCB parameters from the library, call the function <a class="el" href="class_photosynthesis_model.html#a3e47f7c5fe8100cf93ba9454b911bba4">PhotosynthesisModel::setFarquharCoefficientsFromLibrary()</a> with the species name as an argument. This will automatically set the parameters for all primitives. Alternatively, a vector of UUIDs can be passed to this function to set the parameters for a subset of primitives.</p>
<p>To set the parameters manually, first declare an instance of the <a class="el" href="struct_farquhar_model_coefficients.html">FarquharModelCoefficients</a> structure, and then set the parameters using the member functions of the structure. Finally, call the function <a class="el" href="class_photosynthesis_model.html#a80a8bb51f617da1a7e2d03a67890bf1d">PhotosynthesisModel::setModelCoefficients()</a> with the structure as an argument.</p>
<p>Each parameter has a setter function, which is the means by which the underlying response function to be used is specified.</p>
<p><u>Parameter Temperature Response</u></p><ol type="1">
<li>No temperature response: Call the setter function (e.g., <a class="el" href="struct_farquhar_model_coefficients.html#a6ffd05672ffed3b3558350aa64759af3">FarquharModelCoefficients::setVcmax()</a>) with a single argument. This will make the parameter constant with temperature.</li>
<li>Standard Arrhenius temperature response: Call the setter function (e.g., <a class="el" href="struct_farquhar_model_coefficients.html#a6ffd05672ffed3b3558350aa64759af3">FarquharModelCoefficients::setVcmax()</a>) with two arguments - the first parameter being the value at 25<sup>o</sup>C, and the second being the \(dH_a\) of the parameter temperature response.</li>
<li>Arrhenius temperature response with an optimum: Call the setter function (e.g., <a class="el" href="struct_farquhar_model_coefficients.html#a6ffd05672ffed3b3558350aa64759af3">FarquharModelCoefficients::setVcmax()</a>) with four arguments - the first parameter being the value at 25<sup>o</sup>C, the second being the \(dH_a\) of the parameter temperature response, the third being the \(T_{opt}\) of the parameter temperature response, and the fourth being the \(dH_d\) of the parameter temperature response.</li>
</ol>
<p><u>Light Response</u></p><ol type="1">
<li>Rectangular hyperbola: Call the setter function <a class="el" href="struct_farquhar_model_coefficients.html#aa81a3f91ec33be34b377e641efc83263">FarquharModelCoefficients::setQuantumEfficiency_alpha()</a> to set only the alpha parameter. This will enable the rectangular hyperbola light response. Note also the <a class="el" href="struct_farquhar_model_coefficients.html#aa81a3f91ec33be34b377e641efc83263">FarquharModelCoefficients::setQuantumEfficiency_alpha()</a> function can be called with multiple arguments in order to specify a temperature response as described above.</li>
<li>Non-rectangular hyperbola: Call both setter functions <a class="el" href="struct_farquhar_model_coefficients.html#aa81a3f91ec33be34b377e641efc83263">FarquharModelCoefficients::setQuantumEfficiency_alpha()</a> and <a class="el" href="struct_farquhar_model_coefficients.html#a26bc4485aa9294a084fd37d96be1d59f">FarquharModelCoefficients::setLightResponseCurvature_theta()</a>. This will enable the non-rectangular hyperbola light response. Each of these can also be called with multiple arguments to specify a temperature response as described above.</li>
</ol>
<p>Note that the parameter sets in the library vary in terms of which response functions are used based on the data available for parameter fitting.</p>
<div class="fragment"><div class="line"><a class="code hl_class" href="class_photosynthesis_model.html">PhotosynthesisModel</a> photosynthesismodel(&amp;context);</div>
<div class="line"> </div>
<div class="line"><span class="comment">//Use the Farquahar-von Caemmerer-Berry model</span></div>
<div class="line">photosynthesismodel.setModelType_Farquhar();</div>
<div class="line"> </div>
<div class="line"><span class="comment">//Use a species from the library</span></div>
<div class="line">photosynthesis.setFarquharCoefficientsFromLibrary(<span class="stringliteral">&quot;almond&quot;</span>);</div>
<div class="line"> </div>
<div class="line"><span class="comment">//Or set parameters manually:</span></div>
<div class="line"><a class="code hl_struct" href="struct_farquhar_model_coefficients.html">FarquharModelCoefficients</a> fmc;</div>
<div class="line">fmc.<a class="code hl_function" href="struct_farquhar_model_coefficients.html#a6ffd05672ffed3b3558350aa64759af3" title="Set Vcmax of the Farquhar-von Caemmerer-Berry model to a constant value with no temperature response.">setVcmax</a>(74.5, 76.1);                    <span class="comment">// standard Arrhenius</span></div>
<div class="line">fmc.<a class="code hl_function" href="struct_farquhar_model_coefficients.html#a64c5a3e2177539d1c6c2596d948f4d9f" title="Set Jmax of the Farquhar-von Caemmerer-Berry model to a constant value with no temperature response.">setJmax</a>(180.2, 23.0, 40.65, 502.3);      <span class="comment">// Arrhenius with optimum</span></div>
<div class="line">fmc.<a class="code hl_function" href="struct_farquhar_model_coefficients.html#ad6d86187da7c21c2c6a469c85a181ade" title="Set Triose-Phosphate Utilization (TPU) of the Farquhar-von Caemmerer-Berry model to a constant value ...">setTPU</a>(7.7, 24.0, 41.1, 496.4);          <span class="comment">// Arrhenius with optimum</span></div>
<div class="line">fmc.<a class="code hl_function" href="struct_farquhar_model_coefficients.html#a385e9bd7fe6164bdff7f6a53d66aa0cc" title="Set mitochondrial respiration rate (Rd) of the Farquhar-von Caemmerer-Berry model to a constant value...">setRd</a>(1.3);                              <span class="comment">// No temperature response</span></div>
<div class="line"><span class="comment">//setting both alpha and theta, so will use non-rectangular hyperbola light response</span></div>
<div class="line">fmc.<a class="code hl_function" href="struct_farquhar_model_coefficients.html#aa81a3f91ec33be34b377e641efc83263" title="Set light response quantum efficiency (alpha) of the Farquhar-von Caemmerer-Berry model to a constant...">setQuantumEfficiency_alpha</a>(0.304);       <span class="comment">// No temperature response</span></div>
<div class="line">fmc.<a class="code hl_function" href="struct_farquhar_model_coefficients.html#a26bc4485aa9294a084fd37d96be1d59f" title="Set light response curvature (theta) of the Farquhar-von Caemmerer-Berry model to a constant value wi...">setLightResponseCurvature_theta</a>(0.601);  <span class="comment">// No temperature response</span></div>
<div class="line"> </div>
<div class="line">photosynthesis.setModelCoefficients(fmc); <span class="comment">//setting the parameters manually for all primitives (will override the library parameters)</span></div>
<div class="line"> </div>
<div class="line">photosynthesismodel.run();</div>
</div><!-- fragment --><h1><a class="anchor" id="EmpiricalDescription"></a>
Empirical Model Description</h1>
<p>The net photosynthetic rate is described by the equation:</p>
<p>\(A = A_{sat} f_L f_T f_C - R_d\)</p>
<p>\(A_{sat}\,({\mu}mol/m^2-s)\) is the photosynthesis assimilation rate at saturating irradiance and reference temperature ( \(T_{ref}\)) and intercellular CO<sub>2</sub> concentration ( \(C_{i,ref}\)).</p>
<h2><a class="anchor" id="LightResponse"></a>
Light Response Function</h2>
<p>The response of photosynthesis to light is given by a simple exponential function, which is defined by only one parameter:</p>
<p>\(f_L(i) = \dfrac{i}{\theta+i}\),</p>
<p>where \(\theta\) is the light response curvature.</p>
<h2><a class="anchor" id="TempResponse"></a>
Temperature Response</h2>
<p>It is assumed that the maximum CO<sub>2</sub> assimilation rate \(A_{max}\) decreases exponentially about some optimum temperature \(T_{opt}\). The temperature response function is given by:</p>
<p>\(f_T(T_s) = \left(\dfrac{T_s-T_{min}}{T_{ref}-T_{min}}\right)^q\left(\dfrac{(1+q)T_{opt}-T_{min}-qT_s}{(1+q)T_{opt}-T_{min}-qT_{ref}}\right)\),</p>
<p>where \(T_{min}\) is the minimum temperature at which assimilation occurs, \(T_{opt}\) is the temperature at which the maximum assimilation rate occurs, \(T_{ref}\) is the reference temperature chosen to define \(A_{ref}\), and \(q\) is a shape parameter.</p>
<p>The "dark" respiration rate \(R_d\) is assumed to increase exponentially with temperature following the Arrhenius equation (and assumed not to vary with ambient CO<sub>2</sub> concentration). Thus, the dark respiration rate is calculated simply as</p>
<p>\(R_d = R\sqrt{T_s}\mathrm{exp}\left(-E_R/(T_s+273)\right)\),</p>
<p>where \(R\) and \(E_R\) are parameters, and temperature is in Kelvin.</p>
<h2><a class="anchor" id="CO2Response"></a>
CO2 Response Function</h2>
<p>We assume that the maximum assimilation rate varies linearly with intercellular CO<sub>2</sub> concentration over the range of expected concentrations, and is zero at zero CO<sub>2</sub>. Thus, the response function is simply</p>
<p>\(f_C(C_i) = k_C\dfrac{C_i}{C_{i,ref}}\),</p>
<p>where \(C_i\) is intercellular CO<sub>2</sub> concentration ( \(\mu\)mol CO<sub>2</sub>/mol air).</p>
<h2><a class="anchor" id="Ci"></a>
Intercellular CO2 Concentration</h2>
<p>The intercellular CO<sub>2</sub> concentration is estimated as a function of the boundary-layer conductance, stomatal conductance, and ambient CO<sub>2</sub> concentration outside of the primitive boundary-layer. The rate of transport of CO<sub>2</sub> to the leaf (i.e., assimilation rate) is given by</p>
<p>\(A = 0.75g_M\left(C_{amb}-C_i\right)\),</p>
<p>where \(g_M\) is the conductance to moisture from the sub-stomatal cells to outside of the boundary-layer. The 0.75 factor comes from the fact that diffusion of CO<sub>2</sub> in air is slower than that of water vapor (see Eq. 7.33 of <a href="http://www.springer.com/us/book/9780387949376#otherversion=9781461216261">Campbell and Norman</a>).</p>
<p>Since \(A\) is dependent on \(C_i\) and vice-versa, an iterative solution is required for \(A\).</p>
<h2><a class="anchor" id="PhotoCalib"></a>
Empirical Model Calibration Procedure</h2>
<h3><a class="anchor" id="PhotoVars"></a>
Summary of Empirical Model Independent Variables</h3>
<table class="doxtable">
<tr>
<th>Variable</th><th>Units</th><th>Description </th></tr>
<tr>
<td>\(i\)</td><td>W/m<sup>2</sup></td><td>Photosynthetic radiation energy flux. </td></tr>
<tr>
<td>\(T_s\)</td><td>Kelvin</td><td>Surface temperature. </td></tr>
<tr>
<td>\(C_{amb}\)</td><td>\(\mu\)mol CO<sub>2</sub>/mol air</td><td>Ambient CO<sub>2</sub> concentration outside of boundary-layer. </td></tr>
<tr>
<td>\(g_{bl}\)</td><td>mol air/m<sup>2</sup>-s</td><td>Boundary-layer conductance. </td></tr>
<tr>
<td>\(g_s\)</td><td>mol air/m<sup>2</sup>-s</td><td>Stomatal conductance. </td></tr>
</table>
<h3><a class="anchor" id="PhotoParams"></a>
Summary of Empirical Model Parameters</h3>
<table class="doxtable">
<tr>
<th>Parameter</th><th>Units</th><th>Description </th></tr>
<tr>
<td>\(A_{sat}\)</td><td>mol CO<sub>2</sub>/m<sup>2</sup>-sec</td><td>Assimilation rate at saturating irradiance and reference temperature and intercellular CO<sub>2</sub> concentration. </td></tr>
<tr>
<td>\(\theta\)</td><td>W/m<sup>2</sup></td><td>Shape parameter for response to light. </td></tr>
<tr>
<td>\(T_{min}\)</td><td>Kelvin</td><td>Minimum temperature at which assimilation occurs. </td></tr>
<tr>
<td>\(T_{opt}\)</td><td>Kelvin</td><td>Temperature at which maximum assimilation rate occurs. </td></tr>
<tr>
<td>\(q\)</td><td>unitless</td><td>Temperature response shape function. </td></tr>
<tr>
<td>\(R\)</td><td>\({\mu}\)mol K<sup>1/2</sup>/m<sup>2</sup>-s</td><td>Pre-exponential factor for respiration temperature response. </td></tr>
<tr>
<td>\(E_R\)</td><td>1/Kelvin</td><td>Respiration temperature response rate. </td></tr>
<tr>
<td>\(k_C\)</td><td>unitless</td><td>CO<sub>2</sub> response rate. </td></tr>
</table>
<h3><a class="anchor" id="PhotoLightParam"></a>
Response of Assimilation Rate to Light</h3>
<p>The response of the assimilation rate to light is obtained from gas exchange measurements at reference temperature ( \(T_{ref}\)) and CO<sub>2</sub> ( \(C_{i,ref}\)) in which the irradiance is varied across some range. However, one important detail is that the dark respiration rate should be removed such that \(A=0\) in the dark (see plot below). This can be done by measuring the net CO<sub>2</sub> flux starting in the dark, then subtracting the dark flux from the total flux for each subsequent light level.</p>
<div class="image">
<img src="LightResponse.png" alt=""/>
</div>
<h3><a class="anchor" id="PhotoTempParam"></a>
Response of Assimilation Rate to Temperature</h3>
<p>The response of the assimilation rate to temperature is obtained using gas exchange measurements at saturating light levels and the reference CO<sub>2</sub> concentration. The temperature is varied across some range, and the assimilation rate is measured. It is assumed that the optimum temperature \(T_{opt}\) is the temperature corresponding to the maximum measured assimilation rate. The model is fit to the data to determine \(T_{min}\) and \(q\).</p>
<div class="image">
<img src="TempResponse.png" alt=""/>
</div>
<h3><a class="anchor" id="PhotoRespParam"></a>
Response of Respiration Rate to Temperature</h3>
<p>The response of the dark respiration to temperature is obtained using gas exchange measurements in the dark. The leaf is first acclimated to the dark chamber, then leaf temperature is varied across some range. The model is then fit to the data to determine parameters.</p>
<div class="image">
<img src="RespResponse.png" alt=""/>
</div>
<h3><a class="anchor" id="PhotoCO2Param"></a>
Response of Assimilation Rate to CO2</h3>
<p>The response of the assimilation rate is obtained using gas exchange measurements at saturating light levels and the reference temperature \(T_{ref}\), but with varying external CO<sub>2</sub> concentration (which produces varying intercellular CO<sub>2</sub>).</p>
<div class="image">
<img src="CO2Response.png" alt=""/>
</div>
 </div></div><!-- contents -->
</div><!-- PageDoc -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.13.2 </li>
  </ul>
</div>
</body>
</html>
